## 1. hardfault 异常分析

* 当处理器收到异常时，芯片硬件会自动将8个通用寄存器压入当前栈空间（psr、pc、lr、r12、r3、r2、r1、r0）（PendSV 并没有手动压上述8个寄存器，说明确实是自动压栈）
* 如果异常发生时，进入到异常处理函数中前，使用的是 PSP，则上面8个寄存器压入 PSP（线程sp，普通函数sp），否则就压入了MSP（异常 SP）,这两个 sp 指向的空间是不同的
* 因此，为了找到触发异常时的PC值，必须找到异常时的sp是指向那里的
* 通过 LR 判断出异常产生时 sp 是msp还是psp。当异常产生时，LR 会被更新为异常返回时需要使用的特殊值（EXC_RETURN）,因此，通过查看LR寄存器的第2位是0（MSP）还是1(PSP)
* 然后拿到相应的SP地址，通过搜索该地址，然后找到这8个寄存器的值是啥，然后拿到PC的值了，直接在反汇编中搜这个值，看下PC指向了哪里